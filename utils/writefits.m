function writefits(fname, mat, hdr)% WRITEFITS   write matrix into fitsfile in double precision%% WRITEFITS(FN,M,hdr)  writes M with fitsheader H into fitsfile FN.si=size(mat);%Show matrix center%[N, M]=size(mat)%mat(N/2-1:N/2,N/2-1:N/2) = 2;if ~exist('hdr')    hdr=ones(36,80)*32;	hdr=char(hdr);        ln = 1;	hdr(ln,1:11)=['SIMPLE  = T'];	ln = ln+1;	hdr(ln,1:13)=['BITPIX  = -32'];	ln = ln+1;	if length(si)==2,        hdr(ln,1:11)=['NAXIS   = 2'];	elseif length(si)==3,        hdr(ln,1:11)=['NAXIS   = 3'];	end	ln = ln+1;	line = ['NAXIS1  = ' sprintf('%d',si(1))];	hdr(ln,1:length(line))=line;	ln = ln+1;	line = ['NAXIS2  = ' sprintf('%d',si(2))];	hdr(ln,1:length(line))=line;	ln = ln+1;	if length(si)==3,        line = ['NAXIS3  = ' sprintf('%d',si(3))];        hdr(ln,1:length(line))=line;        ln = ln+1;	end	hdr(ln,1:3)=['END'];	hdr=hdr';	hdr=hdr(:);else    hdr=hdr';    hdr=hdr(:);endfid=fopen(fname, 'w','b');cnt=fwrite(fid,hdr,'char');%cnt1=fwrite(fid,mat(:),'int32');cnt1=fwrite(fid,mat(:),'real*4');cnt=cnt+cnt1*4;  % bytes writtennzer=(2880-rem(cnt,2880))/4;fwrite(fid,zeros(nzer,1),'real*4');fclose(fid);